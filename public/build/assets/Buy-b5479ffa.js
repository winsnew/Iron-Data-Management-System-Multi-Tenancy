import{r as a,j as e,I as ue,d as xe}from"./app-623ed0f4.js";import{a as f}from"./axios-28bc18a3.js";import{d as pe}from"./Update-0995898d.js";import{H as ge}from"./Homepage-08511e85.js";import{d as fe}from"./Visibility-3806cdff.js";import{T as o,M as I,B as _,a as l,P as je}from"./Box-957a2bf3.js";import{T,F as D,I as ye,S as be}from"./TextField-5a304923.js";import{M as L}from"./MenuItem-d02030d1.js";import{T as we,a as ve,b as Ce,c as B,d as Se}from"./TableRow-d2f5aa9a.js";import{T as s}from"./TableCell-3fbb70b1.js";import{C as Ie}from"./Checkbox-774633df.js";import{T as _e}from"./TablePagination-9505c5d0.js";import"./IconButton-3addbdd0.js";import"./listItemTextClasses-8727f840.js";const Je=({buy:P,Receive:d,Supplier:Te,ReceiveRaw:De,OrderRawDetail:Be,OrderRaw:Pe})=>{const[ke,N]=a.useState([]),[Me,H]=a.useState([]),[W,z]=a.useState(!1),[Y,U]=a.useState(!1),[i,m]=a.useState({order_raw_no:"",date:"",supplier_id:"",weight_order_total:"",amount_order_total:"",note:"",status:""}),[u,k]=a.useState(null),[q,G]=a.useState(null),[j,J]=a.useState(""),[y,M]=a.useState(0),[x,K]=a.useState(5),Q=window.location.href,[c,O]=a.useState("");a.useState(!1);const[R,E]=a.useState(!1),[Oe,V]=a.useState([]),X=(t,r)=>{t.target.checked?O([r]):O([])},Z=(t,r)=>{M(r)},ee=t=>{K(parseInt(t.target.value,10)),M(0)};a.useEffect(()=>{const t=P.filter(r=>r&&r.order_raw_no?r.order_raw_no.toLowerCase().includes(j.toLowerCase()):!1);H(t)},[P,j]);const p=async()=>{try{const t=await xe.Inertia.visit(Q,{method:"get",data:{},replace:!1,preserveState:!1,preserveScroll:!1});N(t)}catch(t){console.error("Error fetching items:",t)}};a.useEffect(()=>{},[]);const te=async()=>{try{await f.post("/receive-order",i),b(),m({order_raw_no:"",date:"",supplier_id:"",weight_order_total:"",amount_order_total:"",note:"",status:""}),p()}catch(t){console.error("Error adding item:",t)}},ae=()=>{try{f.delete(`/receive-order/${q}`).then(()=>{w()}),p()}catch(t){console.error("Error deleting item:",t)}},re=async()=>{try{await f.put(`/receive-order/${u}`,i),b(),m({order_raw_no:"",date:"",supplier_id:"",weight_order_total:"",amount_order_total:"",note:"",status:""}),k(null),p()}catch(t){console.error("Error updating item:",t)}},se=()=>{u?re():te()},$=()=>{b()},b=()=>{z(!1),m({order_raw_no:"",date:"",supplier_id:"",weight_order_total:"",amount_order_total:"",note:"",status:""}),k(null)},w=()=>{U(!1),G(null)},v=t=>{m({...i,[t.target.name]:t.target.value})},ne=t=>{J(t.target.value)},oe=t=>{const r=t.map(n=>d.find(h=>h.id===n));E(n=>({...n,combinedData:{isOpen:!0,selectedItems:r}}))},C=()=>{E(!1)};console.log(c);const le=async t=>{try{const r=t.map(n=>d.find(h=>h.id===n));V(r),await f.post("/buy",{selectedItemsDetails:r}),C(),p()}catch(r){console.error("Error during buy confirmation:",r)}};return console.log(c),e.jsxs(ge,{children:[e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:e.jsx(o,{variant:"h4",children:"Buy"})}),e.jsx("hr",{style:{color:"white"}}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:"10px"},children:[e.jsx(o,{}),e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:e.jsx(T,{label:"Search..",variant:"outlined",value:j,onChange:ne,style:{width:"150px"},size:"small"})})]}),e.jsx(I,{open:W,onClose:$,"aria-labelledby":"add-item-modal","aria-describedby":"form-for-adding-or-editing-item",children:e.jsxs(_,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:540,bgcolor:"background.paper",boxShadow:24,p:4},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,children:u?"Edit Material":"Add Material"}),e.jsx(D,{fullWidth:!0,sx:{mb:2},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(o,{variant:"body1",style:{marginRight:"10px"},children:"Code"}),e.jsx(T,{label:"Code",variant:"outlined",name:"code",value:i.code,onChange:v,sx:{width:"300px"}})]})}),e.jsx(D,{fullWidth:!0,sx:{mb:2},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(o,{variant:"body1",style:{marginRight:"10px"},children:"Name"}),e.jsx(T,{label:"Name",variant:"outlined",name:"name",value:i.name,onChange:v,sx:{width:"300px"}})]})}),e.jsx(D,{fullWidth:!0,sx:{mb:2},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(o,{variant:"body1",style:{marginRight:"10px"},children:"Status"}),e.jsx(ye,{id:"status-label"}),e.jsxs(be,{labelId:"status-label",id:"status",name:"status",value:i.status,onChange:v,sx:{width:"300px"},children:[e.jsx(L,{value:"1",children:"Active"}),e.jsx(L,{value:"0",children:"Inactive"})]})]})}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"20px"},children:[e.jsx(l,{variant:"contained",color:"primary",onClick:se,children:u?e.jsx(pe,{}):"Save"}),e.jsx(l,{variant:"contained",color:"secondary",onClick:$,style:{marginLeft:"10px"},children:"Cancel"})]})]})}),e.jsx(I,{open:Y,onClose:w,"aria-labelledby":"delete-confirmation-modal","aria-describedby":"confirmation-dialog-for-deleting-item",children:e.jsxs(_,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:370,bgcolor:"background.paper",boxShadow:24,p:4,textAlign:"center"},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,children:"Are you sure you want to delete this item?"}),e.jsx(l,{variant:"contained",color:"primary",onClick:ae,children:"Yes"}),e.jsx(l,{variant:"contained",color:"secondary",onClick:w,style:{marginLeft:"10px"},children:"Cancel"})]})}),e.jsxs("div",{children:[e.jsx(we,{component:je,style:{marginTop:"20px"},children:e.jsxs(ve,{size:"small",children:[e.jsx(Ce,{children:e.jsxs(B,{children:[e.jsx(s,{}),e.jsx(s,{children:e.jsx("b",{children:"RC No."})}),e.jsx(s,{children:e.jsx("b",{children:"Date"})}),e.jsx(s,{children:e.jsx("b",{children:"Warehouse"})}),e.jsx(s,{children:e.jsx("b",{children:"Note"})}),e.jsx(s,{children:e.jsx("b",{children:"Status"})}),e.jsx(s,{children:e.jsx("b",{children:"Setting"})})]})}),e.jsx(Se,{children:d.length>0?d.slice(y*x,y*x+x).map((t,r)=>{var A,F;let n=new Date(t.updated_at),S=n.getFullYear(),h=String(n.getMonth()+1).padStart(2,"0"),ie=String(n.getDate()).padStart(2,"0"),de=String(n.getHours()).padStart(2,"0"),ce=String(n.getMinutes()).padStart(2,"0"),he=String(n.getSeconds()).padStart(2,"0"),me=`${S}-${h}-${ie} ${de}:${ce}:${he}`;return e.jsxs(e.Fragment,{children:[e.jsx(I,{open:(A=R.combinedData)==null?void 0:A.isOpen,onClose:()=>C(),"aria-labelledby":"delete-confirmation-modal","aria-describedby":"confirmation-dialog-for-deleting-item",children:e.jsxs(_,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:370,bgcolor:"background.paper",boxShadow:24,p:4,textAlign:"center"},children:[e.jsxs(o,{variant:"h6",gutterBottom:!0,children:["Are you sure you want to Buy this?",(F=R.combinedData)==null?void 0:F.selectedItems.map(g=>e.jsxs("div",{children:[g.recieve_raw_no,","]},g.id))]}),e.jsx(l,{variant:"contained",color:"primary",onClick:()=>le(c),children:"Yes"}),e.jsx(l,{variant:"contained",color:"secondary",onClick:()=>C(),style:{marginLeft:"10px"},children:"Cancel"})]})}),e.jsxs(B,{children:[e.jsx(s,{children:e.jsx(Ie,{checked:c.includes(t.id),onChange:g=>X(g,t.id)})}),e.jsx(s,{children:t.recieve_raw_no}),e.jsx(s,{children:me}),e.jsx(s,{children:t.name})," ",e.jsx(s,{children:t.note}),e.jsx(s,{children:t.status==1?"Received":"Draft"}),e.jsx(s,{children:e.jsx(ue,{href:"/detail-buy/"+t.id,children:e.jsx(fe,{style:{color:"grey"}})})})]},t.id)]})}):e.jsx(B,{children:e.jsx(s,{align:"center",colSpan:7,children:"No data available"})})})]})}),e.jsx("hr",{style:{color:"white"}}),e.jsx(_e,{rowsPerPageOptions:[5,10,25],component:"div",count:d.length,rowsPerPage:x,page:y,onPageChange:Z,onRowsPerPageChange:ee})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx(l,{size:"small",variant:"contained",color:"success",onClick:()=>oe(c),style:{marginRight:"10px",width:"100px"},children:"Save"})})]})};export{Je as default};

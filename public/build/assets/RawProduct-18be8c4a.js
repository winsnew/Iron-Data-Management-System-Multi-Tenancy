import{r as i,j as e,H as ze,d as C}from"./app-623ed0f4.js";import{a as A}from"./axios-28bc18a3.js";import{a as Se,d as ve}from"./Delete-420f6154.js";import{H as Ce,G as r}from"./Homepage-08511e85.js";import{u as we,T as u,a as y,M as L,B as _,P as Ie}from"./Box-957a2bf3.js";import{u as Re}from"./useMediaQuery-3b20bec3.js";import{S as Me}from"./Snackbar-339c9b43.js";import{M as Pe}from"./Alert-010238a0.js";import{T as m,F as w}from"./TextField-5a304923.js";import{M as b}from"./MenuItem-d02030d1.js";import{T as De}from"./TablePagination-9505c5d0.js";import{I as X}from"./IconButton-3addbdd0.js";import{D as ke,G as Ae}from"./DataGrid-8c21cbfe.js";import"./listItemTextClasses-8727f840.js";import"./TableCell-3fbb70b1.js";import"./index-cc45ed25.js";import"./Autocomplete-3ca91d15.js";import"./Checkbox-774633df.js";const Ke=({rawProducts:z,materials:I,unit:T,rawproduct:S})=>{var W;i.useState([]);const[Q,Y]=i.useState([]),[q,$]=i.useState(!1),[J,E]=i.useState(!1),[n,d]=i.useState({code:"",material_id:"",size1:"",size2:"",unit1:"",unit2:"",status:""}),[j,R]=i.useState(null),[K,F]=i.useState(null),[M,V]=i.useState("");i.useState([]),i.useState(""),i.useState("");const[Z,N]=i.useState(0),[ee,te]=i.useState(5),[se,x]=i.useState(!1),[ae,g]=i.useState(""),[ie,f]=i.useState("success"),O=()=>{x(!1)},re=(t,s)=>{N(s)},ne=t=>{te(parseInt(t.target.value,10)),N(0)};i.useEffect(()=>{S&&d({...n,unit1:S.unit,status:S.status})},[S]),i.useEffect(()=>{const t=z.filter(s=>s.size&&s.size.toLowerCase().includes(M.toLowerCase()));Y(t)},[z,M]);const le=async()=>{var t,s;try{await A.post("/raw-product",n),P(),d({code:"",material_id:"",size:"",status:""}),C.Inertia.reload(),f("success"),g("Item added successfully"),x(!0)}catch(a){console.error("Error adding item:",a);const l=((s=(t=a.response)==null?void 0:t.data)==null?void 0:s.error)||"Error adding item";f("error"),g(l),x(!0)}},oe=t=>{F(t),xe()},de=()=>{try{A.delete(`/raw-product/${K}`).then(()=>{D(),C.Inertia.reload(),f("success"),g("Raw product deleted successfully"),x(!0)})}catch(t){console.error("Error deleting raw product:",t),f("error"),g("Error deleting raw product"),x(!0)}},ce=t=>{R(t.id),console.log(t.size);const[s,a,l,o]=ge(t.size);d({code:t.code,material_id:t.material_id,size1:s||"",size2:l||"",unit1:a||"",unit2:o||"",status:t.status}),G()},ue=async()=>{var t,s;try{const a=j||"new",l=`${n.size1||""} x ${n.size2||""} mm`;await A.put(`/raw-product/${j}`,{...n,size:l}),P(),d({code:"",material_id:"",size1:"",size2:"",status:""}),R(null),C.Inertia.reload(),f("success"),g("Item added successfully"),x(!0)}catch(a){console.error("Error adding item:",a);const l=((s=(t=a.response)==null?void 0:t.data)==null?void 0:s.error)||"Error adding item";f("error"),g(l),x(!0)}},me=()=>{j?(ue(),C.Inertia.reload()):le()},B=()=>{P()},G=()=>{$(!0)},P=()=>{$(!1),d({code:"",material_id:"",size:"",status:"",size1:"",size2:""}),R(null)},xe=()=>{E(!0)},D=()=>{E(!1),F(null)},k=t=>{if(d({...n,[t.target.name]:t.target.value}),t.target.name==="material_id"){const s=I.find(a=>a.id===t.target.value);d(a=>({...a,code:s?`${s.code}${n.size1||""}X${n.size2||""}`:""}))}},H=(t,s)=>{const a=t.target.value.trim();(/^-?\d*\.?\d*$/.test(a)||a==="")&&d(l=>{var v;const o={...l,[s]:a},p=`${((v=I.find(be=>be.id===o.material_id))==null?void 0:v.code)||""}${o.size1||""}X${o.size2||""}`;return{...o,code:p}})},U=(t,s)=>{const a=t.target.value.trim();d(l=>({...l,[s]:a}))},he=t=>{V(t.target.value)};function pe(t){const a=t.split("x").map(c=>{const p=c.trim();return/^\d*\.?\d*$/.test(p)?parseFloat(p):p}),l=[" "," x "];return a.reduce((c,p,v)=>[c,p].join(l[(v-1)%l.length]))}function ge(t){return t.split("x").map(o=>{const c=o.trim();return/^\d*\.?\d*$/.test(c)?parseFloat(c):c})}const fe=[{field:"no",headerName:"No",editable:!1,width:50},{field:"code",headerName:"Code",editable:!1,width:150},{field:"material_id",headerName:"Material",editable:!1,width:375},{field:"size",headerName:"Size",editable:!1,width:375},{field:"status",headerName:"Status",editable:!1,width:375},{field:"setting",headerName:"Setting",width:150,renderCell:t=>e.jsxs(e.Fragment,{children:[e.jsx(X,{color:"primary",onClick:()=>oe(t.id),size:"small",children:e.jsx(Se,{fontSize:"small"})}),e.jsx(X,{color:"secondary",onClick:()=>ce(t),size:"small",children:e.jsx(ve,{fontSize:"small"})})]})}],je=z.map((t,s)=>({id:t.id,no:s+1,code:t.code,material_id:t.material_id?t.material.name:"",size:pe(t.size),status:t.status=="0"?"Active":t.status=="1"?"Inactive":"",setting:t})),ye=we(),h=Re(ye.breakpoints.down("sm"));return e.jsxs(Ce,{children:[e.jsx(ze,{title:"Data Master - Raw Product"}),e.jsx(Me,{open:se,autoHideDuration:4e3,onClose:O,anchorOrigin:{vertical:"bottom",horizontal:"right"},style:{marginBottom:"30px",marginRight:"30px"},children:e.jsx(Pe,{elevation:6,variant:"filled",severity:ie,onClose:O,children:ae})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap"},children:[e.jsx(u,{variant:"h4",children:"Raw Products"}),e.jsx(y,{variant:"contained",color:"primary",size:"small",onClick:G,children:"Add new"})]}),e.jsx("hr",{style:{color:"white"}}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:"10px"},children:[e.jsx(u,{}),e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:e.jsx(m,{label:"Search..",variant:"outlined",value:M,onChange:he,style:{width:"150px"},size:"small"})})]}),e.jsx(L,{open:q,onClose:B,"aria-labelledby":"add-raw-product-modal","aria-describedby":"form-for-adding-or-editing-raw-product",children:e.jsxs(_,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:h?"90%":"80%",bgcolor:"background.paper",boxShadow:24,p:4,borderRadius:5},children:[e.jsx(u,{variant:"h6",gutterBottom:!0,children:j?"Edit Raw Product":"Add Raw Product"}),e.jsx(w,{fullWidth:!0,sx:{mb:2},children:e.jsxs(r,{container:!0,spacing:2,children:[e.jsx(r,{item:!0,xs:4,alignItems:"center",justifyContent:"flex-start",style:{display:"grid",placeItems:"center",textAlign:"left"},children:e.jsx(u,{variant:"body1",children:"Code"})}),e.jsx(r,{item:!0,xs:8,children:e.jsx(m,{label:"Code",variant:"outlined",name:"code",value:n.code,onChange:k,sx:{width:"100%"},InputProps:{readOnly:!0},disabled:!0,size:"small"})})]})}),e.jsx(w,{fullWidth:!0,sx:{mb:2},children:e.jsxs(r,{container:!0,spacing:2,children:[e.jsx(r,{item:!0,xs:4,alignItems:"center",justifyContent:"flex-start",style:{display:"grid",placeItems:"center",textAlign:"left"},children:e.jsx(u,{variant:"body1",children:"Material"})}),e.jsx(r,{item:!0,xs:8,children:e.jsx(m,{label:"Material",select:!0,id:"material_id",name:"material_id",value:n.material_id,onChange:k,sx:{width:"100%"},size:"small",children:I.map(t=>e.jsx(b,{value:t.id,children:t.name},t.id))})})]})}),e.jsx(w,{fullWidth:!0,sx:{mb:2},children:e.jsxs(r,{container:!0,spacing:2,children:[e.jsx(r,{item:!0,xs:4,alignItems:"center",justifyContent:"flex-start",style:{display:"grid",placeItems:"center",textAlign:"left"},children:e.jsx(u,{variant:"body1",children:"Size"})}),e.jsx(r,{item:!0,xs:8,children:e.jsxs(r,{container:!0,spacing:h?1:2,alignItems:"center",children:[e.jsx(r,{item:!0,xs:h?6:3,children:e.jsx(m,{label:"Size",variant:"outlined",name:"size1",value:n.size1||"",sx:{width:"100%"},onChange:t=>H(t,"size1"),size:"small",autoComplete:"off"})}),e.jsx(r,{item:!0,xs:h?6:2.5,children:e.jsx(m,{select:!0,label:"Unit",name:"unit1",value:n.unit1||"",onChange:t=>U(t,"unit1"),sx:{width:"100%"},size:"small",children:T.map(t=>e.jsx(b,{value:t.unit,children:t.unit},t.id))})}),e.jsx(r,{item:!0,xs:h?12:1,style:{textAlign:"center"},children:"X"}),e.jsx(r,{item:!0,xs:h?6:3,children:e.jsx(m,{label:"Size",variant:"outlined",name:"size2",value:n.size2||"",onChange:t=>H(t,"size2"),sx:{width:"100%"},size:"small",autoComplete:"off"})}),e.jsx(r,{item:!0,xs:h?6:2.5,children:e.jsx(m,{label:"Unit",select:!0,name:"unit2",value:n.unit2||"",onChange:t=>U(t,"unit2"),sx:{width:"100%"},size:"small",children:T.map(t=>e.jsx(b,{value:t.unit,children:t.unit},t.id))})})]})})]})}),e.jsx(w,{fullWidth:!0,sx:{mb:2},children:e.jsxs(r,{container:!0,spacing:2,children:[e.jsx(r,{item:!0,xs:4,alignItems:"center",justifyContent:"flex-start",style:{display:"grid",placeItems:"center",textAlign:"left"},children:e.jsx(u,{variant:"body1",children:"Status"})}),e.jsx(r,{item:!0,xs:8,children:e.jsxs(m,{select:!0,label:"Status",id:"status",name:"status",value:n.status,onChange:k,sx:{width:"100%"},size:"small",children:[e.jsx(b,{value:"0",children:"Active"}),e.jsx(b,{value:"1",children:"Inactive"})]})})]})}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"20px"},children:[e.jsx(y,{variant:"contained",size:"small",color:"primary",onClick:me,children:j?"Update":"Save"}),e.jsx(y,{variant:"contained",size:"small",color:"secondary",onClick:B,style:{marginLeft:"10px"},children:"Cancel"})]})]})}),e.jsx(L,{open:J,onClose:D,"aria-labelledby":"delete-confirmation-modal","aria-describedby":"confirmation-dialog-for-deleting-raw-product",children:e.jsxs(_,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:370,bgcolor:"background.paper",boxShadow:24,p:4,textAlign:"center",borderRadius:5},children:[e.jsx(u,{variant:"h6",gutterBottom:!0,children:"Are you sure you want to delete this raw product?"}),e.jsx(y,{variant:"contained",color:"primary",size:"small",onClick:de,children:"Yes"}),e.jsx(y,{variant:"contained",color:"secondary",size:"small",onClick:D,style:{marginLeft:"10px"},children:"Cancel"})]})}),e.jsxs("div",{children:[e.jsx(_,{style:{width:"100%"},children:e.jsx(ke,{disableColumnSelector:!0,disableDensitySelector:!0,density:"compact",size:"small",sx:{"--DataGrid-overlayHeight":"300px",boxShadow:2},component:Ie,rows:je,columns:fe,slots:{toolbar:Ae},slotProps:{toolbar:{showQuickFilter:!0}},initialState:{pagination:{paginationModel:{pageSize:5}},columns:{...(W=z.initialState)==null?void 0:W.columns,id:{hide:!0}}}})}),e.jsx(De,{rowsPerPageOptions:[5,10,25],component:"div",count:Q.length,rowsPerPage:ee,page:Z,onPageChange:re,onRowsPerPageChange:ne})]})]})};export{Ke as default};
